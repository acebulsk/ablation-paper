---
title: "Ablation of Intercepted Snow: Insights from In-Situ Observations in the Canadian Rockies"
format: 
  docx:
    reference-doc: ../config/Copernicus_Word_template.docx
    number-sections: true
    toc: false
    lang: en-CA
  pdf:
    pdf-engine: latexmk
    pdf-engine-opt: -xelatex
    colorlinks: false
    keep-tex: true
    # latex-clean: false # keeps log file
    number-sections: true
    toc: false
    fig-pos: H # makes figs appear in the location specified. without this they sometimes appear in the middle of a paragraph.
    linestretch: 1.5 # set inline instead
editor: source
bibliography: ../../papers/bibtex/better-bibtex.bib
csl: '../../papers/bibtex/csl-styles/apa-disable-disambiguate-add-names.csl'
---

\setstretch{1.5} 

<!-- For most journals, Research Articles are allowed to be up to 25 publication units (PU), where 1 PU is 500 words or 1 display element (figure or table). Research Letters for Geophysical Research Letters have a maximum length of 12 publication units. Longer papers are not considered in GRL and will be returned for shortening. -->

<!-- Word count does NOT include the title, authors, affiliations, key points, keywords, text in tables (but not captions) and references. Longer papers are assessed an excess length fee. For most journals, Commentaries are limited to 6 publication units (recommended length is about 2000 words and 1-2 figures). -->

```{r, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')

source('scripts/results/qunld-analysis/00-results-figs-setup.R')
source('scripts/get-manuscript-values.R')

# met averages for periods snow was in the canopy w/o precip
ft_met_w_cpy_snow <- inner_join(ft_met, events_fltr_long)

mean_t <- mean(ft_met_w_cpy_snow$t) |> round(1)
mean_u <- mean(ft_met_w_cpy_snow$u) |> round(1)
max_15min_u <- max(ft_met_w_cpy_snow$u) |> round(1)

n_canopy_snow_events <- nrow(canopy_snow_events)
```

**Authors:**

Alex C. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

John W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^Centre for Hydrology, University of Saskatchewan, Canmore, Canada

**Corresponding Author:** Alex C. Cebulski, alex.cebulski@usask.ca

**Key Points:**

-   New insights on the processes driving canopy snow ablation are presented based on in-situ observations and simulations from a novel process-based hydrological model.
-   Canopy snow unloading was observed to be strongly associated with canopy snow load, wind speed and canopy snowmelt.
-   Implementation of a revised canopy snow energy balance and unloading routine resulted in enhanced prediction of canopy snow ablation particularly for warm events compared to conventional approaches.

**Abstract** 

Existing canopy snow ablation parameterizations have been shown to have uncertain transferability across differing climate and forest types. Moreover, many of the theories underlying the existing parameterizations have not been tested extensively across climate and forest types. Here, novel snow interception process understanding, developed from fine-scale and high-frequency observations collected from needleleaf forests in the Canadian Rockies, is used to decouple the processes that initially load snow in the canopy from those that ablate it. A revised snow interception parameterization that calculates throughfall as a function of forest structure, is presented with modified canopy snow ablation parameterizations, and implemented in the Cold Regions Hydrological Modelling platform to simulate canopy snow load and subcanopy snowpack dynamics. To assess the effectiveness of these new parameterizations, simulations using both new and traditional routines were evaluated against observations of subcanopy snow water equivalent and canopy snow load at sites not used in model development, including the continental climate Marmot Creek, Alberta; subarctic climate Wolf Creek, Yukon Territory; and coastal climate Russell Creek, British Columbia (all in  Canada). Preliminary results show that the revised interception parameterization improves predictability, increasing the R2 compared to measurements from 0.4 with existing methods to 0.7 with the revised routine. This improved process understanding of snow interception and canopy snow ablation processes may have broad applicability and reliability, improving water resource assessment of forested, snow-dominated basins.


Thesis outline:

 Previous studies have developed parameterizations to represent ablation processes including unloading, melt, drip and sublimation of snow intercepted in the canopy. However, these parameterizations have been shown to have uncertain transferability to new environments and have not yet been tested in discontinuous forest canopies. This study presents new in-situ measurements of canopy snow ablation processes and contrasts these observations with existing theories and models. Analysis of the canopy snow mass balance showed that unloading, drip and melt contributed to 60% of canopy snow ablation on average over two years with the remainder being attributed to canopy snow sublimation. The probability of unloading, drip and melt was observed to increase with air temperature and wind speed. However, the probability of wind induced unloading was observed to decrease at warmer air temperatures. The probability of unloading due to warming was also observed to decline when wind speeds were above 1 m s-1. The increase in cohesion and adhesion of snow in the canopy at warmer temperatures and cooling due to wind-induced evaporation may contribute to the interaction multivariate interaction between air temperature, wind speed and canopy snow unloading. Exponential relationships were observed between both air temperature and wind speed with unloading and drip, which were also dependent on the amount of snow intercepted in the canopy. In comparison to existing models, this discontinuous forest exhibited unloading and drip due to warming at lower air temperatures. Conversely, wind-induced unloading occurred at higher wind speeds than predicted by current models.

# Introduction

Accurate models of the seasonal subcanopy snowpack rely on a comprehensive understanding of snow interception and canopy snow ablation processes. The time that snow resides in the canopy, and is subjected to high rates of sublimation, is dependent on rates of canopy snow ablation processes. Existing theories on the initial loading of snow in the canopy are highly divergent and of uncertain application to differing environments, partly due to their varying inclusion of processes that ablate snow from the canopy.

The objective of this study is to determine if the theoretical underpinnings and assumptions behind existing canopy snow ablation parameterisations are supported by in-situ observations collected from a subalpine forest in the Canadian Rockies. This study specifically looks at canopy snow ablation after snowfall, initial interception has been discused in @Cebulski2025.

Research Questions:

1. How does air temperature, wind, canopy snow sublimation and snowmelt influence the rate of snow unloading?

2. To what extent do current theoretical models of canopy snow ablation align with in-situ observations?

3. What modifications of existing models, if any, are necessary to accurately represent ablation of snow intercepted in the canopy and what is the performance of the updated model?

Hypotheses:

  a. Melt induces unloading (loss of structural integrity, particle bond weakening, lubrication)
  b. Sublimation induces unloading (loss of structural integrity and particle bond weakening)
  c. Wind induces unloading (shear stress on snow, wind erosion and branch movement)
  d. Temperature induces unloading (increased elasticity of branches)

<!-- ![The @Ellis2010 and @Floyd2012 predicted unloading and drip rate (left) and the @Roesch2001 unloading rate (right) with increasing air temperature. Wind speed for the RW01 parameterisation was set to zero.](figs/examples/unloading_drip_hp98_rw01.png){#fig-unl-ex-temp} -->

<!-- ![The @Roesch2001 (RW01) predicted unloading rate with increasing wind speed and constant air temperature of -10°C.](figs/examples/roesch_unloading.png){#fig-unl-ex-wind} -->

# Study Site and Instrumentation

The observations presented in this study were collected at Fortress Mountain Research Basin (FMRB), AB, -115° W, 51° N, a continental headwater basin in the Canadian Rockies at 2100 m above sea level. Air temperature, humidity, and wind speed were measured at a height of 4.3 m at Forest Tower (FT) Station (@fig-site-map). The precipitation rate was measured by an Alter-shielded OTT Pluvio weighing precipitation gauge installed 2.6 m above ground at Powerline Station. Incoming and outgoing solar radiation was measured by a Kipp & Zonen CNR4 4-Component Net Radiometer installed 3.27 m above the ground at Fortress Ridge Station. Three subcanopy lysimeters, consisting of a plastic horse-watering trough with an opening of 0.9 m^2^ and depth of 20 cm suspended from a load cell, were installed to measure canopy snow unloading. A weighed tree lysimeter (subalpine fir) suspended from a load cell (Artech S-Type 20210-100) measured the weight of canopy snow load (kg) and was scaled to an areal estimate of snow load (mm) using snow surveys as in @Pomeroy1993a. Additional details on this study site and the meteorological and lysimeter measurements have been described in @Cebulski2025a. Four tipping bucket rain gauges, 3 Texas Electronics TR-525M and 1 Hyquest Solutions TB4MM were installed along a 15 m transect adjacent to the dense canopy subcanopy lysimeter to measure canopy snowmelt drainage. To isolate the subcanopy lysimeter measurements of canopy snow unloading from throughfall, 15-min intervals were selected that met the following criteria: no atmospheric precipitation, and snow was observed to be intercepted in the canopy using the weighed tree and timelapse imagery investigation.

A CSAT measured shear stress ... however it was frequently covered with snow during the ablation periods. So to provide a complete record of shear stress, a relationship between wind speed at 4.3 m at FT station and shear stress from the CSAT (see supporting information). Shear stress was then gap filled when the CSAT was covered with snow using this relationship.

![Map showing the location of forest plots, flux towers, subcanopy lysimeter instruments, and survey transects. The inset map on the lower right shows the regional location of Fortress Mountain Research basin.](figs/study-site/site_map_inset.png){#fig-site-map}

# Methods

## Statistics on Canopy Snow Unloading Relationships

### Combined influence of predictors on unloading 

The influence of air temperature, wind speed, snow load, melt, and sublimation on the unloading process was assessed using a multivariate ordinary least squares regression. The subcanopy lysimeter unloading measurements had a high relative instrument error due to the relatively small accumulation of unloaded snow over the 15-min intervals. To improve instrument accuracy, while maintain consistency of the unloading measurements with wind speed, the 15-min interval measurements of unloading were aggregated over differing predictor variable bins. The predictor variable bins included: air temperature and wind speed measured at FT station, canopy snow load from the weighed tree lysimeter (scaled to the canopy of each respective subcanopy lysimeter), and canopy snowmelt and sublimation simulated in CRHM. Sublimation was simulated using @eq-ql following @Essery2003 and snowmelt calculated using available energy from @eq-eb both implemented in CRHM, were used for this analysis. Bins that had accumulated unloaded snow less than 0.1 mm were removed which resulted in a mean instrument error of +/- 2% for the remaining bins. The individual processes found to be significant predictors of unloading in the multivariate regression (i.e., shear stress and canopy snow melt) were then isolated to parameterise a model of their effects.

### Wind induced unloading

The rate of canopy snow unloading due to wind, shear stress and canopy snow load was quantified by the subcanopy lysimeters during intervals without canopy snowmelt. By excluding periods influenced by melt, the snow captured by the lysimeters is attributed primarily to wind-driven unloading. While unloading caused by snow metamorphism or thermally induced branch bending may also contribute, the measured unloading is interpreted to be predominantly from wind-induced unloading over these intervals. The relationship between wind speed, shear stress, canopy snow load, and unloading was investigated for these periods using a non-linear least squares regression.

### Canopy snowmelt induced unloading 

A mass balance approach was incorporated to determine the unloading rate resulting from canopy snowmelt ($q_{unld}^{melt}$, mm s^-1^). The influence of canopy snowmelt on $q_{unld}^{melt}$ was then assessed by fitting a linear model using an ordinary least squares regression. Since direct measurements of canopy snow unloading are challenging to obtain independently from canopy snowmelt drainage [@Storck2002], the following mass balance was incorporated to determine $q_{unld}^{melt}$ as a residual:

$$
\frac{dL}{dt} = 
[q_{sf} - q_{tf} + q_{ros}] - [q_{unld}^{melt} + q_{unld}^{wind}] - q_{drip} - q_{wind}^{veg} - q_{sub}^{veg}
$$ {#eq-canopy-mass-bal}

where $\frac{dL}{dt}$ is the change in canopy snow load over time, (mm s^-1^), $q_{sf}$ is the snowfall rate (mm s^-1^), $q_{tf}$ (mm s^-1^) is the throughfall rate (mm s^-1^), $q_{ros}$ (mm s^-1^) is the rate of rainfall falling on snow intercepted in the canopy, $q_{unld}^{melt}$ is the canopy snow unloading rate due to melt (mm s^-1^), $q_{unld}^{wind}$ is the canopy snow unloading rate due to wind (mm s^-1^), $q_{drip}$ is the canopy snow drip rate due to canopy snowmelt (mm s^-1^), $q_{wind}^{veg}$ is the wind transport rate in or out of the control volume (mm s^-1^), and $q_{sub}^{veg}$ is the intercepted snow sublimation rate (mm s^-1^). Figure 1 in @Cebulski2025 presents a visual representation of this mass balance. 

Then @eq-canopy-mass-bal was rearranged to solve for $q_{unld}^{melt}$ during intervals without $[q_{sf} - q_{tf} + q_{ros}]$ or $q_{wind}^{veg}$ as:

$$
q_{unld}^{melt} = -\frac{dL}{dt} - q_{drip} - q_{unld}^{wind} - q_{sub}^{veg}
$${#eq-unld-melt-mass-bal}

While some components of the canopy snow mass balance can be measured directly with relative ease, such as $\frac{\Delta L}{\Delta t}$ with the weighed tree, sublimation of canopy snow is more difficult to quantify directly especially in forested mountain environments [@Helgason2012b; @Conway2018] and thus $q_{sub}^{veg}$ was simulated in this study in CRHM using @eq-ql as described in @Essery2003. $q_{drip}$ was measured where possible using the tipping buckets, however problems with freezing of liquid water in the devices limited the amount of $q_{drip}$ that could be collected. Thus, $q_{drip}$ was also supplemented with simulated canopy snowmelt in CRHM as in @eq-eb. Canopy snow ablation periods that were dominated by melt were selected for calculating $q_{unld}^{melt}$ where the contribution of $q_{unld}^{wind}$ and $q_{sub}^{veg}$ to canopy snow ablation was less than 5%. 

# Canopy Snow Energy Balance 

A revised canopy snow energy balance is presented here which provided both an approximation of canopy snowmelt and sublimation as these processes could not be measured directly and also for use in the canopy snow ablation routines. The energy available for melting snow intercepted in the canopy, $Q_{melt}$ (W m^-2^), which is a function of the canopy snow load ($L$) was calculated as:

$$
Q_{melt}(L) = 
Q_{sw} +
Q_{lw} +
Q_{p} + Q_{h} + Q_{l} - [C_p^{ice} L \frac{\Delta T_{vs}}{\Delta t}]
$$ {#eq-eb}

where $Q_{sw}$ and $Q_{lw}$ (W m^-2^) are the net shortwave and longwave radiation heat fluxes to the canopy snow, $Q_p$ (W m^-2^), is the advective energy rate, and $Q_{l}$ and $Q_{h}$ (W m^-2^), are the turbulent fluxes of latent heat and sensible heat respectively (positive towards canopy snow), $C_p^{ice}$ (J kg^-1^ K^-1^) is the specific heat capacity of ice, and $\frac{\Delta T_{vs}}{\Delta t}$ (K s^-1^) is the change in canopy snow temperature over time. 

$Q_{sw}$ was determined as:

$$
Q_{sw} = \downarrow Q_{sw} \cdot (1 - \alpha_s) \cdot \tau_{50}^{veg}
$$ {#eq-sw}

where $\downarrow Q_{sw}$ is the downwelling shortwave radiation (W m^-2^), $\alpha_s$ is the albedo of snow intercepted in the canopy (-), $\tau_{50}^{veg}$ (-) is the canopy transmittance to $\downarrow Q_{sw}$. $\tau_{50}^{veg}$ was determined using Equation from @Pomeroy2009 with half of the leaf area index (LAI), following studies [@Weiskittel2009; @Kesselring2024], who report that approximately 50% of the total leaf area is concentrated in the upper half of coniferous canopies. This provides an approximation of the mean $Q_{sw}$ to all snow intercepted in the canopy, and is a simplification from using a partial differential equation to determine the radiation incident to individual height layers within the canopy. Upwelling shortwave radiation reflected off of the surface snowpack is considered negligible contribution to the snow intercepted in the canopy as it is primarily blocked by vegetation elements underlying the canopy snow. 

$Q_{lw}$ was approximated as:

$$
Q_{lw} = \downarrow Q_{lw}^{atm} + \uparrow Q_{lw}^{veg} + \uparrow Q_{lw}^{veg2veg} - Q_{lw}^{vs}
$$ {#eq-lw}

where $Q_{lw}^{atm}$ is the downwelling longwave radiation from the atmosphere (W m^-2^), $Q_{lw}^{veg}$ is the longwave radiation upwelling from vegetation elements underlying snow intercepted in the canopy (W m^-2^), $Q_{lw}^{veg2veg}$ is the downwelling longwave radiation emitted from the underside of the vegetation elements reflected by the subcanopy snowpack (W m^-2^), and $Q_{lw}^{vs}$ (W m^-2^) is the outgoing longwave radiation from the top and bottom of the canopy snow layer calculated as:

$$
Q_{lw}^{vs} = 2 \epsilon_{s} \sigma T_{vs}^4
$$ {#eq-lw-vs}

where $\epsilon_s$ is the emissivity (-) of snow taken as 0.99 and $\sigma$ is the Stefan–Boltzmann (5.67e-10 W m^-1^ K^-4^). $Q_{lw}^{atm}$ was approximated in this study as in @Sicart2006 to take into account the influence of atmospheric moisture on emissivity. $Q_{lw}^{veg}$ was calculated with the assumption that canopy elements were in equilibrium with the air temperature plus any change in vegetation temperature from the extinction of $\downarrow Q_{sw}$ in the canopy [@Pomeroy2009, Eq. 4].

$Q_p$ was calculated as:

$$
Q_p = [C_p^{wtr} m_r(T_r - T_{vs}) + C_p^{ice} m_s(T_s - T_{vs})] / \Delta t
$$ {#eq-qp}

where $C_p^{wtr}$ is the specific heat capacity of water (J kg^-1^ K^-1^), $m_r$ is the specific mass of liquid water in precipitation (mm), $T_r$ is the rainfall temperature (K), $m_s$ is the specific mass of snow in precipitation (mm), and $T_s$ is the snowfall temperature (K). 

$Q_h$ was calculated as:

$$
Q_h = \frac{\rho_a}{r_a} C_p^{air} (T_a - T_{vs})
$$ {#eq-qh}

where $\rho_a$ is the air density (kg m^-3^), $C_p^{air}$ is the specific heat capacity of air (J kg^-1^ K^-1^), $T_a$ is the air temperature, and $r_a$ is the aerodynamic resistance (s m^-1^) which was approximated from Equation 4 from @Allan1998 as:

$$
r_a = \frac{\text{log}(\frac{z_T - d_0}{z_0})\text{log}(\frac{z_u - d_0}{z_0})}{\kappa^2 u_z}
$$ {#eq-ra}

where $z_T$ is the height of temperature measurement (m), $d_0$ is the displacement height (m) which was approximated as 2/3^rd^ the mean canopy height, $z_0$ is the roughness length (m) which was approximated as 1/10^th^ of the mean canopy height, $z_u$ is the wind speed measurement height (m), $\kappa$ is von Karman's constant, 0.41 (-), and $u_z$ is the wind speed measurement at $z_u$ (m s^-1^). 

$Q_l$ was calculated as:

$$
Q_l = \frac{\rho_a}{r_i+r_a} (q_a(T_a) - q_{vs}(T_{vs}))
$$ {#eq-ql}

where $r_i$ is a resistance for transport of moisture from intercepted snow to the canopy air space [Eq. 28 in @Essery2003], $q_a(T_a)$ and $q_{vs}(T_{vs})$ are the specific humidity (-) at the air temperature and canopy snow temperature respectively. If the height of the air temperature measurement differs from the humidity measurement the $z_T$ term in the @eq-ra should be adjusted to use the the humidity measurement height. 

The above sensible and latent heat flux equations assume neutral atmospheric stability conditions, i.e., nearly adiabatic conditions (no heat exchange) which may be appropriate for application with snow which is intercepted in the roughness elements where stability corrections may not be required [@Allan1998]. This is also supported by the uncertainty of stability correction in forest canopies [@Conway2018] and mountain environments [@Helgason2012a]. Solving @eq-eb requires an iterative solution to determine $\Delta T_{vs}$ and the remaining terms which are also a function of $T_{vs}$. 

# Modelled Canopy Snow Energy and Mass Balance

The energy and mass balance of canopy snow was simulated using the Cold Regions Hydrological Model (CRHM) to evaluate the new canopy snow ablation routine. A full description of the CRHM model is described in @Pomeroy2007 and the up to date source code is available at https://github.com/srlabUsask/crhmcode. In addition to the updated parameterizations presented in this study, parameterizations from previous studies that simulate canopy snow unloading, melt, and sublimation were also implemented and compared against the updated routine within CRHM. Canopy snow sublimation simulations also provided the rate of sublimation needed in @eq-unld-melt-mass-bal.

In addition to the updated parameterizations presented in this study, three other canopy snow routines were implemented in CRHM following previous studies by @Ellis2010 and @Floyd2012 (hereafter Ellis2010), @Roesch2001 (Roesch2001), and @Andreadis2009 (Andreadis2009). The @Ellis2010 routine was previously integrated into CRHM as a module and is the one typically used to simulated snow accumulation in forests in CRHM and was run as is. The Ellis2010 module includes canopy snow sublimation as described in @Pomeroy1998b, canopy snow unloading over time from @Hedstrom1998a with modifications described in @Floyd2012 to handle canopy snow melt and drip processes using an ice-bulb temperature threshold. The Roesch2001 routine represents canopy snow unloading and melt using wind and air temperature functions. The Andreadis2009 parameterization unloads snow as a function of canopy snowmelt alone, following observations by @Storck2002 and does not include wind induced unloading. The snowmelt rate from @eq-eb was used to calculate the unloading rate for the Andreadis2009 unloading. The default parameters provided by each individual study were used here and were not calibrated. More details on the aforementioned parameterizations are described in @Cebulski2025.

# Results

## Canopy Snow Unloading Relationships

A statistically significant positive relationship (*p* < 0.05, *R^2^* = `r lm_multi_reg_tbl$Adj_R2[1] |> round(2)`) was identified between canopy load, canopy snowmelt, wind speed, and the rate of canopy snow unloading, as measured by the subcanopy lysimeters and provided the highest *R^2^* compared to other models tested (@tbl-q-unld-bins). Shear stress was found to explain less variability compared to wind speed, when combined with canopy snow load and snowmelt (*p* < 0.05, *R^2^* = `r lm_multi_reg_tbl$Adj_R2[4] |> round(2)`). The effect of air temperature and canopy snow sublimation was found to be insignificant (*p* > 0.05) for all regression tests (@tbl-q-unld-bins). Canopy snow unloading exhibited a much higher degree of variance (0–2 mm/hr) across the canopy snowmelt and sublimation bins compared to the air temperature and wind speed bins, which only varied between 0–0.5 mm/hr. As a result, models without canopy snowmelt explained substantially less variation in unloading. Additional model tests for differing combinations of independent variables are shown in the supporting information section.

The mean unloading rate was observed in @fig-q-unld-all-bins to increase with increasing canopy snowmelt, wind speed, shear stress, and canopy load. Despite the insignificant relationships, air temperature and canopy snow sublimation were positively associated with canopy snow unloading, though for sublimation this relationship was limited to sublimation rates between 0 and 0.3 mm hr^-1^ (@fig-q-unld-all-bins). For sublimation rates higher than 0.3 hr^-1^, unloading is observed to decline with increasing sublimation, as more canopy snow is partitioned to the atmosphere. A decline in unloading is observed for wind speed bins above 3 m s^-1^ which is attributed to some wind transport of canopy snow, and potential entrainment into the atmosphere, and corresponding increased sublimation rates.

```{r tbl-q-unld-wind, echo=FALSE}
#| label: tbl-q-unld-bins
#| tbl-cap: "Summary of multiple linear regression results evaluating all combinations of predictor variables for canopy snow unloading including: canopy load ($L$), wind speed ($u$), canopy snowmelt rate ($q_{melt}$), canopy snow sublimation rate ($q_{subl}$), and air temperature ($T_a$). Columns L to Ta show the coefficient estimate for each respective term, and the significance of each term is shown in brackets. Significance codes: * = p < 0.05; ns = not significant (p > 0.05). The models are ranked by their corresponding AIC value."
#| tbl-colwidths: [11, 13, 13, 14, 12, 14, 8, 8]


lm_multi_reg_tbl_slim |> 
  select(`Model Name`,
         intercept,
         L,
         u,
         q_melt,
         q_subl,
         tau,
         # T_ib_dep,
         T_a,
         Adj_R2,
         AIC) |>
  knitr::kable(col.names = c(
  'Model Name',
  'Intercept',
  '$L$',
  '$u$',
  '$q_{melt}$',
  '$q_{subl}$',
  '$\\tau$',
  # '$T_a - T_{ice}$',
  '$T_a$',
  '$R^2$',
  'AIC'
))
```

![Scatter plots showing the mean canopy snow unloading rate for differing bins of wind speed (m/s), air temperature (°C), canopy snowmelt (mm/hr), canopy snow sublimation (mm/hr). Note: canopy snow unloading was measured by the subcanopy lysimeters, air temperature and wind speed were measured at FT station, canopy snowmelt and sublimation were modelled in CRHM.](figs/results/explore/scl_q_unld_vs_bins.png){#fig-q-unld-all-bins}

### Wind Induced Unloading

Canopy snow unloading measurements from the subcanopy lysimeters, filtered to include intervals without canopy snowmelt, followed a positive linear relationship with shear stress (*p* < 0.05, *R^2^* = `r q_unld_wind_r2`) and a positive exponential relationship with wind speed (*p* < 0.05, *R^2^* = `r q_unld_tau_r2`). Shear stress explained slightly more variability in unloading, which may be attributed to its better relation to kinetic energy compared to wind speed. However, there is significant scatter among the differing bins and uncertainty within each bin related to both models. The wind-induced unloading rate was observed to be higher for bins with higher canopy snow load across nearly all bins (@fig-q-unld-wind). The *R^2^* of both the shear stress and wind speed relationships is much higher than the amount of variance explained by wind speed when including intervals with melting snow (@tbl-q-unld-bins). The increased liquid water content during the canopy snowmelt process may provide some resistance to wind induced unloading. However, a statistically significant negative influence of air temperature on wind speed could not be found, likely due to the strong positive association of air temperature and melt on unloading. Moreover, increased canopy snow unloading during low wind speeds, resulting from high melt rates could also contribute to the lower explanatory power of wind speed in @tbl-q-unld-bins. The higher *R^2^* of the shear stress model compared to wind speed, coupled with the better phyical representation of kinetic energy, provided the reasoning for selecting shear stress as the independent variable to predict wind-induced unloading.

![Canopy snow unloading rate measured by the subcanopy lysimeters versus shear stress (left) and wind speed (right) during periods without canopy snowmelt. The dots show the mean unloading rate for bins of shear stress and wind speed. The error bars show +/- 1 standard deviation above and below the mean. The fitted lines show predictions from @eq-ftau (left) and @eq-fu (right). )](figs/results/modelled_tau_wind_unloading_w_obs.png){#fig-q-unld-wind}

```{r tbl-q-unld-wind, echo=FALSE}
#| label: tbl-q-unld-wind
#| tbl-cap: "Summary of the performance and regression coefficients for the relationship between canopy snow unloading with wind speed (@eq-fu) and shear stress (@eq-ftau) as shown in @fig-q-unld-wind. Note: the coefficients are developed for hourly unloading."

wind_tau_err_tbl |> knitr::kable()
```

The wind-driven canopy snow unloading rate, $q_{unld}^{wind}$, is represented as a linear function of shear stress, as illustrated in @fig-q-unld-wind. This function is defined as:

$$
q_{unld}^{wind} = L \cdot \tau_{mid} \cdot a
$${#eq-q-unld-wind}

where $\tau_{mid}$ is the shear stress at mid canopy height, and $a$ is a constant found to be `r mod_coef_tau_a` (m^-1^) through ordinary least squares regression for the observations presented in @fig-q-unld-wind.

### Melt induced unloading

A positive linear relationship was found between the canopy snow unloading to melt ratio and canopy snow load (*p* < 0.05, *R^2^* = `r q_unld_melt_r2`) for canopy snow ablation events with less than 5% contribution of wind induced unloading and/or sublimation (@fig-unld-melt-ratio). This was represented by the equation:

$$
q_{unld}^{melt} = f(m) \cdot q_{melt}(L)
$${#eq-q-unld-melt}

where $f(m)$ is the ratio of unloading to canopy snowmelt and $q_{melt}$ is the canopy snowmelt rate (mm hr^-1^). @eq-q-unld-melt is similar to Equation 33 in @Andreadis2009; however, instead of assuming a constant value of 0.4 for $f(m)$, it was determined as:

$$
f(m) = m \cdot L + b
$${#eq-fm}

where $m$ and $b$ were determined as `r q_unld_melt_m` and `r q_unld_melt_b`, respectively, using an ordinary least squares regression. The regression was performed using the data shown in @fig-unld-melt-ratio, which presents the ratio of canopy snow unloading, derived from the weighed tree, to simulated canopy snowmelt across bins of canopy snow load.

![The ratio of canopy snow unloading (weighed tree residual) to snowmelt across different canopy snow load bins and events. Black dots represent the observed cumulative observed unloading divided by the cumulative simulated snowmelt. Red dots show the cumulative observed unloading divided by snowmelt measured by the tipping buckets. Multiple dots within a bin correspond to different events. The blue line represents the best-fit line derived from ordinary least squares regression.](figs/results/modelled_melt_unloading_ratio_vs_snow_load_bin.png){#fig-unld-melt-ratio}

## Evaluation of canopy snow ablation parameterisations

The updated canopy snow ablation routine resulted in a reduced mean bias of `r new_model_mb_avg` mm compared to existing models which had a mean biases ranging from `r old_mods_mb_range[1]` to `r old_mods_mb_range[2]` mm when assessed with hourly weighed tree ablation and averaged across all events. For snowmelt dominant events, defined as events with over 60% of their simulated canopy snow ablation coming from snowmelt, the new routine was most improved with an average mean bias of `r melt_new_model_mb_avg` mm compared to the existing parameterisations which had a mean biases ranging from `r melt_other_mb_avg[1]` to `r melt_other_mb_avg[2]` mm (@fig-obs-mod-cpy-load-mb). For sublimation dominant events, with over 60% of their simulated canopy snow ablation from sublimation, there was less of a difference between the updated and existing routines (@fig-obs-mod-cpy-load-mb). Since the @Essery2003 sublimation parameterisation, used in the updated routine is largely based on the @Pomeroy1998b routine used by the other simulations these were expected to be similar. A slight improvement in performance was observed for sublimation events in the updated routine, particularly during clear-sky nights, which led to cooling of the canopy snow surface temperature. This effect could be represented in the @Essery2003 routine but not in the @Pomeroy1998b routine, which assumes that the canopy snow surface temperature remains in thermoequilibrium with the air temperature (@fig-obs-mod-w-tree). See event '2022-03-24' in @fig-obs-mod-w-tree for an example of this where the rate of sublimation slows at night an better matches the observation compared to the other models. Events with over 60% of their canopy snow ablation coming from wind-induced unloading, show the importance of taking into account this process, with models that simulate wind-induced unloading having lower mean bias of `r wind_roesch_mb_avg` for the @Roesch2001 linear model and `r wind_new_model_mb_avg` in the exponential model proposed in @fig-q-unld-wind compared to the mean bias of `r wind_nr_mb_avg` for the two simulations that do not directly incorporate wind-induced unloading. The inconsistent performance of the wind unloading parameterisations shown in @fig-obs-mod-w-tree, and reduced performance compared to the melt and sublimation events, may be explained by in-situ observations of an inconsistent relationship of wind speed and unloading which may be attributed to melt/freeze of snow adhering to the canopy and thermal equilibrium metamorphasism increasing the cohesion of snowclumps.

\pagebreak
\setstretch{1.0} 
```{r tbl-event-met, echo=FALSE}
#| label: tbl-event-met
#| tbl-cap: "Meteorology of the 17 select ablation events. Air temperature, relative humidity, and wind speed were measured at FT station. The process fractions show the fraction of canopy snow ablation for each process."

pretty_table <- readRDS('tbls/select_event_met_stats_maxmin_pretty_gt_table.rds')
pretty_table
# gt::as_raw_html(pretty_table)

# knitr::include_graphics('figs/event_avgs_maxmin_pretty_gt_table_screenshot.png')
```
\setstretch{1.5}

```{r tbl-obs-mod-stats-avg, echo=FALSE}
#| label: tbl-obs-mod-stats-avg
#| tbl-cap: "Model error statistics between hourly observed (weighed tree) and simulated (CRHM) canopy snow ablation. The Mean bias (MB) is the difference in the model and observed values, MAE is the mean of the absolute error, RMSE is the root mean squared error, NRMSE is the normalised RMSE, R is the pearson correlation coefficient, and *R*^2^ is the pearson correlation coefficient squared. The 'name' column represents the parameterisation set used to simulate canopy snow ablation."
#| tbl-colwidths: [20, 13, 13, 13, 13, 13]

obs_mod_stats_avg |> knitr::kable()
```

![Bar chart showing the simulated fraction of total canopy snow ablation attributed to the individual processes melt, sublimation and wind induced unloading for the 17 selected ablation events. .](figs/crhm-analysis/model-comparison/mod_frac_ablation_no_subl_unld_updt_wind_pars2.png){#fig-sim-frac-abl}

![Boxplots illustrating the distribution of mean bias in canopy snow ablation simulations across different parameterisation sets for each event type, evaluated using observations from the weighed tree.](figs/crhm-analysis/model-comparison/obs_mod_canopy_snow_load_event_type_mean_bias_boxplot_no_subl_unld_updt_wind_pars.png){#fig-obs-mod-cpy-load-mb}

![Canopy snow load time series for individual events measured by the weighed tree (Observed) and simulated using the various parameterisation sets.](figs/crhm-analysis/model-comparison/obs_mod_canopy_snow_load_no_subl_unld_updt_wind_pars.png){#fig-obs-mod-w-tree width=85%}

![Cumulative canopy snow drip from the mean of the tipping buckets (TB_mean) and the updated canopy snowmelt routine (crhm_drip).](figs/results/crhm_vs_tb_drip_events_no_subl_unld_updt_wind_pars.png){#fig-obs-mod-cpy-load-mb width=85%}

![Mean bias across the select canopy snow ablation events vs mean event air temperature coloured by mean event wind speed.](figs/crhm-analysis/model-comparison/obs_mod_mean_bias_vs_temp_shear_stress_unld_v4.png){#fig-obs-mod-cpy-load-mb width=85%}

""

# Discussion

The inclusion of processes that ablate snow intercepted in the canopy is prevalent in many parameterisations for the initial loading of snow within the canopy. Many of these processes are related to the amount of time that snow resides in the canopy prior to the interception measurement was conducted in addition to wind and temeprature induced unloading processes. After filtering out unloading due to temperature and wind the duration snow was intercepted in the canopy was found as a third important factor to consider. Unloading due to duration initially starts high while the snow is fresh and has low cohesion and adhesion and as the snow metamorphasizes the adhesion and cohsesion increases for the first 15 hours and the probability of unloading declines. After 15 hours the probability of unloading increases potentially due to increased sublimation and metamorphasism of snow intercepted in the canopy which reduces its adhesion and cohesion.

A new unloading routine could be established based on these observations after filtering to remove temperature and wind induced unloading which show the probability of unloading after this filtering is high after initial loading of snow intercepted in the canopy, followed by a decline in probability until around 15 hours, and increases afterwards. This could be combined with the unloading rate which was observed to be high as the snow was initially loaded in the canopy and then declines steadily with increasing duration.

Based on the canopy snowmelt model, the @Storck2002 ratio based melt based unloading parameterisation over estimates drip. It could also be that the parv snowmelt model is underestimating the canopy snow temperature.

Generally, model over estimates canopy snow wind induced unloading when wind speed < 1 m/s (see weighed tree events 2023-02-26, 2023-01-28). Under estimates when wind speed > 1 m/s (see events 2023-02-24).

Sometimes the overestimate of wind unloading for < 1 m/s is associated with higher canopy snow loads (see 2023-02-24 at the start, and 2023-03-14 at the start). But not necessarily for 2022-12-01 and 2023-03-25/26/28 which both either underestimate $q_unld^wind$ or have good performance with high canopy snow loads.

Underestimates canopy snowmelt for colder/near 0 events (see 2023-03-25)

2023-03-26 not sure why ablation late on the 26th, as high humidity (~100%) and not too high wind speeds (~1m/s)

The wind dominated ablation events have much poorer performance, aside from 2022-12-01 which aligns well on average.

The sublimation or snowmelt dominated events, which are less influenced by wind have the best performance.

 The wind model is slightly less sensitive, with lower unloading rates at the same wind speeds compared to the @Roesch2001 relationships.

Not currently taking into account different density of unloaded snow, or over time as it melts in the canopy.

The melt unloading ratio increases with canopy snowmelt rate which as a result also increases as a function of canopy snowmelt. Air temperature is also indirectly included as canopy snowmelt is also a function of air temperature in this model. Air temperature could also have a negative impact on canopy snow unloading as a result of melt but this was not found in the observations presented here due to the larger effect of melt on unloading compared to the relationship with adhesion and cohesion and air temperature along.

Model does not account for wind redistribution of snow which may underestimate for some windy events or branch bending due to warming (directy) or warming of the canopy surface greater than the air temperature.

Unloading rate proportional to sublimation may also handle unloading/snowmelt not captured by curent canopy snow algorithm which has canopy snow temperature equal to air temperature

Energy balance method relies on quality net radiation measurements which are not always certain while air temperature based methods may be more reliable.

The improved representation of the canopy snowmelt process is attributed to an improved representation of the energy to the canopy snowpack as described in @eq-eb. This allows rate of canopy snowmelt to better reflect the available energy and also @eq-q-unld-melt helps represent the associated increase in canopy snow unloading with snowmelt (@fig-obs-mod-w-tree). Another benefit of the energy balance method is it allows the canopy snow to cool during clear nights where the LW losses are greater than incoming LW from the atmosphere due to low atmosphereic emissivity from lack of clouds which improved the simulation of the sublimation events [see event 2022-03-24 in @fig-obs-mod-w-tree]. Compared to the previous model which ablate at a higher rate due to increased sublimation driven by low humidities without considering the surface temperature cooling.

Improved representation of wind-induced unloading could be obtained by tracking the adhesion of snow to the canopy through melt/freeze or vapour deposition processes and cohesion due to equitemperature metamorphasism.

remaining gap on how much liquid water the canopy / canopy snow can hold.

much higher snow loads observed in @Cebulski2025a and thus the exposure coef in @Pomeroy1998b was adjusted

despite not including the wind transport process, the new model performed well for windy events. 

the higher variability of unloading during melt periods may have muted the wind induced unloading signal for these periods.

@Essery2003 latent heat resistance as function of canopy fullness not included in @Essery2025

More canopy snow unloading with wind when snow is not melting (less cohesive and less dense)

the temperature of snowfall was observed as a rough indicator of the influence of temp on unloading. if snow fell cold branches were stiff and more horizontal, if fell warm then branches were more compressible theres a lag effect there that may have limited the influence of air temp on unloading in our observations

While there are advantages of treating initial interception and ablation processes separately, these parameterizations still need to be combined and tested together.

From JP: The shear stress makes better physical sense than wind speed for erosion or triggered of canopy snow by wind as it relates to the kinetic energy.  It makes sense that this is for times when the intercepted snow is not melting and so is less cohesive and probably less dense.
 
# Conclusions

<!-- -   Over two winter seasons, the primary processes contributing to canopy snow ablation were unloading, drip, and sublimation. Wind redistribution of canopy snow was determined to be a small component of the mass balance. -->
-   When considering all canopy snow ablation periods in our observations canopy snow load, wind speed, and canopy snowmelt were found to be statistically significant predictors, explaining 80% in the variability in canopy snow unloading.
-   Shear stress, was found to be a stronger predictor of canopy snow unload (R2 = 0.66) compared to wind speed (R2 = 0.52) for non-melt periods. 
-   The observed associations of canopy snow unloading with wind speed and air temperature were represented in a new canopy snow ablation routine. An exponential function represents the increase in canopy snow unloading with wind speed which is also moderated by canopy snow load. Snow unloading during melt is represented as a ratio of the snow melt rate which depends on the canopy snow load. This routine accounts for cooling effects when snow evaporates from the canopy decreasing the rate of temperature induced unloading for increased wind speeds.
-   The canopy snow exposure coef from existing studies was found to be too small at this site and needed to be increased substantially
-   The amount of drip compared to mass release of canopy snow was found to be significatnly less in this study compared to previous studies which suggested primarily drip
-   The proposed new model is is more consistent across a wide range of temperatures and wind speeds.

# Supporting Information 

```{r tbl-q-unld-wind, echo=FALSE}
#| label: tbl-q-unld-bins-full
#| tbl-cap: "Summary of multiple linear regression results evaluating all combinations of predictor variables for canopy snow unloading including: canopy load ($L$), wind speed ($u$), canopy snowmelt rate ($q_{melt}$), canopy snow sublimation rate ($q_{subl}$), and air temperature ($T_a$). Columns L to Ta show the coefficient estimate for each respective term, and the significance of each term is shown in brackets. Significance codes: * = p < 0.05; ns = not significant (p > 0.05). The models are ranked by their corresponding AIC value."
#| tbl-colwidths: [11, 13, 13, 14, 12, 14, 8, 8]


lm_multi_reg_tbl |> 
  select(`Model Name`,
         intercept,
         L,
         u,
         q_melt,
         q_subl,
         tau,
         # T_ib_dep,
         T_a,
         Adj_R2,
         AIC) |>
  knitr::kable(col.names = c(
  'Model Name',
  'Intercept',
  '$L$',
  '$u$',
  '$q_{melt}$',
  '$q_{subl}$',
  '$\\tau$',
  # '$T_a - T_{ice}$',
  '$T_a$',
  '$R^2$',
  'AIC'
))
```

![Wind speed versus shear stress relationship.](../../analysis/eddy-cov/figs/estimate_tau_from_wind/mid_cnpy_wind_squared_VS_canopy_low_shear_stress.png)

![The difference in using analytical solution and ODE unloading equations.](figs/examples/numerical_deamons.png)
# References
