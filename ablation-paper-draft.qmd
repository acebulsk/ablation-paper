---
title: "Paper Draft: The influence of Meteorology on Canopy Snow Ablation"
author: "Alex Cebulski & John Pomeroy"
format: html
editor: source
---

## Introduction

![Example of the @Hedstrom1998a (HP98) and @Roesch2001 (RW01) parameterizations for the calculation of unloading and drip rates with increasing air temperature. Wind speed for the RW01 parameterization was set to zero. Note that the HP98 parameterization does not differentiate unloading processes (i.e., metamorphasism, wind-induced, melt) while the RW01 parameterization here calculates unloading and drip of canopy snow due to warming and melt alone and their wind-induced parameterization is shown separately.](figs/examples/unloading_drip_hp98_rw01.png){#fig-unl-ex-temp}

![Example of the @Roesch2001 (RW01) parameterization for the calculation of wind-induced unloading. Here the air temperature has been set to a constant of -10Â°C to set the unloading rate due to warming to zero. The parameterization was run for a range of canopy snow loads (5, 10, 15, and 20 mm).](figs/examples/roesch_unloading.png){#fig-unl-ex-wind}

## Theory

@Roesch2001 proposed a parameterization to calculate the unloading and drip rate of snow intercepted in the canopy. The @Roesch2001 parameterization couples the unloading and drip rates into one equation. However, by isolating the wind-induced unloading function and using the @Storck2002 mass clump unloading parameterization (without drip) an unloading parameterization due to melt and wind can be developed as:

$$
q_{unld} = q_{unld}^{melt} + q_{unld}^{wind}
$$

where $q_{unld}^{wind}$ is the @Roech2001 method to unload snow as a function of wind speed and $q_{unld}^{melt}$ is the @Storck2002 method to unload mass clumps of snow due to melt. See @Cebulski2024b for a detailed description of the @Roesch2001 and @Storck2002 parameterizations.

## Methods

Our lysimeters measure $q_{unld}$ + $q_{drip}$.

$$
  residual = weighed\ tree \ ablation - measured\ unloading
$$

A positive residual here equates to canopy snow that was ablated and was not accounted for by measured unloading (lysimeters) or modelled sublimation. This is inferred here at unloading by drip, wind redistribution, and measurement error. A negative residual means more snow was either measured in the lysimeters and/or modelled sublimation in CRHM than was actually ablated from the weighed tree.

Partition canopy snow ablation in the above graph into unloading, sublimation, and a residual.

To investigate the influence of individual processes on canopy snow unloading, the subcanopy lysimeters were used. The probability of unloading was calculated as:

$$
p_{unld} = \frac{n}{N}
$$

where $p_{unld}$ is the probability of unloading (-), $n$ is the number of unloading events that occurred in a particular met bin, and $N$ is the total number of occurrences of that met bin.

## Results

### Dominant Ablative Processes Observed

@fig-glob-unl-part shows that unloading and drip were the dominant ablative processes observed over two winter seasons for all periods with snow in the canopy and no atmospheric precipitation. Simulated sublimation rates also make up a significant portion of canopy snow ablation and accounted for most of the residual measured ablation. This suggests that for the average conditions in this wind-exposed subalpine forest, wind redistribution of snow intercepted in the canopy is a relatively small component.

![](figs/results/canopy_snow_ablation_partition_global.png){#fig-glob-unl-part}

@fig-glob-unl-part shows a large increase in the ablation residual with wind speeds above 3.5 m s^-1^ and little association with air temperature. The increase in the residual at high wind speeds is attributed to higher ablation rates measured by the weighed tree due to an associated increase in wind redistribution and sublimation rates. Difficulties in measuring wind redistribution and sublimation rates at this study site limit the ability to partition the residual into these two processes. Modelled sublimation rates shown in @fig-glob-unl-part suggest that for wind speeds above 3.5 m s^-1^ the difference between the residual and modelled sublimation could be attributed to wind redistribution. However, the sublimation parameterization in this simulation has not been tested in wind-exposed forest and may be an underestimate of true sublimation rates at high wind speeds.

![](figs/results/canopy_snow_ablation_partition_cowplot_temp_wind.png){#fig-glob-unl-part-met}

### The Influence of Meteorology on Unloading

-   Possible evidence here for thresholding behaviour below -3 deg. C where there is less liquid water in the canopy snow clumps and more suspeptible to wind induced unloadings. However we also have less frequency of observations here and may limit the interpretation of these results.
-   Less unloading and drip observed for above zero temperatures with wind speeds above 1 m/s which may be attributed to some evaporative cooling.
-   when its cold below we could use the sparse trough because it does not matter it leaks in these temps..

![](figs/results/probability_of_unloading_wind_air_temp.png){#fig-glob-prob-unl}

![](figs/results/frequency_of_unloading_wind_air_temp.png){#fig-glob-freq-unl}

![](figs/results/binned_unloading_rate_and_t_air_class_canopy_load.png){#fig-low-wind-qunl}

![](figs/results/binned_unloading_rate_and_wind_mid_class_tree_load.png){#fig-cold-w-wind-qunl}

### Modelling Canopy Snow Unloading 

Less confidence in the temperature unloading model, maybe better suited to use a physically based snowmelt model. The wind unloading model aligns well with the observations although, only two canopy snow load bins were used. This model is slightly less sensitive, with lower unloading rates at the same wind speeds compared to the @Roesch2001 relationships. 

![](figs/results/modelled_temp_unloading_w_obs.png){#fig-mod-temp-unld}

![](figs/results/modelled_wind_unloading_w_obs.png){#fig-mod-wind-unld}
```{r}
wind_err_tbl <- readRDS('data/modelled_wind_unloading_error_table.rds') |> 
  mutate(model = 'wind_model')
temp_err_tbl <- readRDS('data/modelled_temp_unloading_error_table.rds') |> 
  mutate(model = 'temp_model')

rbind(wind_err_tbl, temp_err_tbl)

```

### Unloading

Snow unloading was investigated during periods of time where snow was in the canopy and no above canopy precipitation was observed. Higher unloading rates were associated with high wind speed or high ice bulb temperature or a combination of both factors. Ice bulb temperature was observed to have a stronger relationship with unloading rates compared to air temperature since the ice bulb temperature is strongly related to sublimation and snowmelt rates which both influence the cohesion and adhesion of snow clumps in the canopy. There was also a negative association of ice-bulb temperature on wind speed. Where an increase in ice-bulb temperature reduced the effectiveness of wind removing snow from the canopy.

![The probability of canopy snow unloading shown at different observed ice-bulb temperatures and 5 m wind speeds.](../../analysis/unloading/figs/probability/fingerprint_plot_icebulb_wind_probability_unloading_avg_troughs.png){#fig-unl-prob}

![The rate of canopy snow unloading within each ice-bulb and wind speed bin over two winter seasons.](../../analysis/unloading/figs/binned_multivariate/fingerprint_plot_icebulb_wind_q_unl_snow_in_canopy_avg_trough.png){#fig-unl-rate}

![The number of canopy snow unloading events within each ice-bulb and wind speed bin over two winter seasons.](../../analysis/unloading/figs/probability/fingerprint_plot_icebulb_wind_frequency_unloading_avg_troughs.png){#fig-unl-freq}

![Cumulative unloaded canopy snow measured over two winter seasons.](../../analysis/unloading/figs/binned_multivariate/fingerprint_plot_icebulb_wind_cuml_unl_snow_in_canopy_avg_trough.png){#fig-unl-cuml} \#### Regression

To describe the reduced wind induced snow unloading at warmer temperatures we can use a multivariate regression.

f \<- function(temp, wind, a, b1, b2, b3) {a \* exp(temp*b1)* exp(wind*b2)* exp(wind*temp*-b3)}

##### Check normality

![Histogram of the log canopy snow unloading rate.](../../analysis/unloading/figs/binned_multivariate/histogram_log_unloading_rate.png){#fig-qunl} ![Histogram of ice-bulb temperature measurements.](../../analysis/unloading/figs/binned_multivariate/histogram_ice_bulb_temp.png){#fig-temp} ![Histogram of wind speed measurements.](../../analysis/unloading/figs/binned_multivariate/histogram_wind_speed.png){#fig-wnd}

##### Show regression results

![Comparison of different non-linear least squares regression models fit to two years of binned canopy snow unloading meausrements.](../../analysis/unloading/figs/binned_multivariate/multivariate_q_unld_wind_w_neg_tempwind_lm_nls_model_compare.png){#fig-unl-reg-binned}

![Observed canopy snow unloading meausrements binned into wind speed and ice bulb temperature.](../../analysis/unloading/figs/binned_multivariate/wind_bin_vs_q_unl_colour_temp.png){#fig-unl-obs-bins} \### Select Events

Below is using heavily filtered data, all of the observations of the ice bulb temp plot have low wind speeds and all of the obs in the within canopy wind speed plot have low temperatures. John suggested it would be better to use a multivariate regression here if possible.

-   Ice Bulb Temperature

![](figs/fortress_warm_events_bin_temp_avg_unloading.bmp)

-   Within Canopy Wind Speed

![](figs/fortress_windy_events_bin_wind_pwl_wind_3cup_avg_unloading.bmp)

\pagebreak

## Conclusions

-   Over two winter seasons wind redistribution of snow intercepted in the canopy was found to be negligible.
-   Canopy snow unloading, drip and sublimation were found to be the primary ablative processes.
-   Observed unloading and drip rates attributed to warming were higher at sub-zero temperatures when the canopy was loaded compared to the HP98 and SA09 models.
-   The observed association between wind speed, canopy load and unloading was similar to the RW01 model. However, at warmer temperatures wind induced unloading was reduced.

# References
